<!doctype html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>招募專區｜INFAS 全國中學生資訊年會 2026</title>
  <meta name="description" content="INFAS 2026 招募專區：職缺、分工、時程、常見問答。內容由 HackMD 公開筆記即時匯入並可搜尋。">
  <meta name="theme-color" content="#2C2C2C" />
  <meta property="og:type" content="website">
  <meta property="og:title" content="INFAS 2026 招募專區">
  <meta property="og:description" content="加入籌備團隊：職缺、分工、時程、FAQ。內容自 HackMD 即時更新。">
  <meta property="og:image" content="/assets/img/og-cover.png">
  <meta property="og:locale" content="zh_TW">

  <link rel="icon" type="image/png" sizes="256x256" href="./favicon256.png" />
  <!-- Use site's global stylesheet per user's request -->
  <link rel="stylesheet" href="assets/css/style.css" />

  <!-- CSP -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 img-src 'self' data: https:;
                 style-src 'self' 'unsafe-inline';
                 script-src 'self' https://font.emtech.cc https://cdn.jsdelivr.net https://unpkg.com 'unsafe-inline';
                 font-src 'self' https://font.emtech.cc data:;
                 connect-src 'self' https://hackmd.io;
                 frame-src https://hackmd.io https://forms.gle https://docs.google.com;
                 base-uri 'self';
                 form-action 'self' https://forms.gle">

  <!-- emfont -->
  <script type="module">
    import "https://font.emtech.cc/emfont.js";
    emfont.init();
  </script>

</head>
<body>
  <a class="skip-link" href="#main">跳到主要內容</a>

  <header class="nav" role="banner">
    <div class="nav-inner">
      <a class="brand" href="index.html" aria-label="INFAS 首頁">
        <img src="./favicon256.png" alt="INFAS logo" class="logo" width="36" height="36" />
        <strong>INFAS 2026</strong>
      </a>
      <nav aria-label="主導覽">
        <div class="nav-links">
          <a href="about.html">關於</a>
          <a href="recruit.html" aria-current="page">招募</a>
          <a href="sponsor.html">贊助</a>
          <a href="policy/privacy.html">隱私權</a>
          <a href="index.html#contact">聯絡</a>
        </div>
      </nav>
    </div>
  </header>

  <main id="main">
    <section class="hero" aria-label="招募">
      <div class="hero-inner">
        <span class="badge"><span class="badge-dot" aria-hidden="true"></span>招募專區 · 內容即時同步</span>
        <div>
          <h1>加入 INFAS 2026 籌備團隊</h1>
          <p>職缺、分工、時程、常見問答，皆由 HackMD 自動同步更新</p>
          <div class="cta-row">
            <a class="btn btn-primary" href="#content">查看招募資訊</a>
            <a class="btn btn-secondary" id="open-hackmd" href="https://hackmd.io/@INFAS/SylYomltgx" target="_blank" rel="noopener">在 HackMD 開啟</a>
          </div>
        </div>
      </div>
    </section>

    <section class="section" aria-label="招募內容">
      <div class="container" id="content" style="display:grid;grid-template-columns:260px 1fr;gap:2rem;">
        <aside aria-label="頁面目錄" style="position:sticky;top:80px;align-self:start">
          <h2 style="margin-top:0">目錄</h2>
          <nav id="toc" class="foot-links" aria-label="章節導覽"></nav>
          <div style="margin-top:1rem">
            <button id="refresh" class="btn btn-secondary" type="button">重新整理內容</button>
          </div>
        </aside>

        <article id="md-root" class="markdown-body" aria-live="polite" aria-busy="true">
          <!-- HackMD 渲染內容 -->
        </article>
      </div>

      <div class="container" id="fallback" hidden>
        <div class="card">
          <p>⚠️ 無法即時抓取 HackMD 內容（可能是網路或 CORS 問題）。以下為備援嵌入：</p>
          <div style="aspect-ratio:16/9;border:1px solid #e5e7eb;border-radius:12px;overflow:hidden">
            <iframe title="HackMD 招募專區" src="https://hackmd.io/@INFAS/SylYomltgx" width="100%" height="100%" style="border:0"></iframe>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer role="contentinfo">
    <div class="footer-inner">
      <div class="foot-grid">
        <div>
          <strong>Information Association of Student（INFAS）</strong>
          <p style="margin:.5rem 0 0 0">中學生資訊年會｜Since 2018</p>
          <div class="foot-past">  
            <p><a href="../2018" aria-disabled="true">2018</a> | <a href="../2017" aria-disabled="true">2017</a> | <a href="../2016" aria-disabled="true">2016</a></p>
          </div>
        </div>
        <div class="foot-links">
          <strong>網站</strong>
          <a href="/">首頁</a>
          <a href="recruit.html">招募</a>
          <a href="sponsor.html">贊助</a>
          <a href="policy/privacy.html">隱私權政策</a>
        </div>
        <div class="foot-links">
          <strong>社群</strong>
          <a href="https://www.facebook.com/infas.club" aria-disabled="true">Facebook</a>
          <a href="https://www.instagram.com/infas.tw" aria-disabled="true">Instagram</a>
          <a href="https://hackmd.io/@INFAS" aria-disabled="true">HackMD</a>
        </div>
      </div>
      <div class="copyright">© 2026 INFAS. All rights reserved.</div>
    </div>
  </footer>

  <!-- Marked + DOMPurify （ESM） -->
  <script type="module">
    import { marked } from 'https://cdn.jsdelivr.net/npm/marked@12/+esm';
    import createDOMPurify from 'https://cdn.jsdelivr.net/npm/dompurify@3.1.7/+esm';

    const DOMPurify = createDOMPurify(window);

    // HackMD-like settings
    marked.setOptions({
      gfm:true, breaks:false, mangle:false, headerIds:false
    });

    // Helper: slugify
    const slugify = (txt) => txt
      .toLowerCase()
      .replace(/[^\p{L}\p{N}\s-]/gu,'')
      .trim()
      .replace(/\s+/g,'-');

    // Extension: admonitions ([!NOTE] + :::info)
    // For :::kind blocks we DO NOT show the "kind" label (per user request).
    const admonitionExt = {
      name: 'admonition',
      level: 'block',
      start(src){
        // 只要出現 [!Kind] 或 ::: 就觸發
        const m = /(?:^|\n)\s*(?:>\s*)?\[\!\s*(?:Note|Tip|Important|Warning|Caution)\]|(?:^|\n)\s*:::/i.exec(src);
        return m ? m.index : undefined;
      },
      tokenizer(src){
        // A) Blockquote 形式：> [!Kind] [可選**標題**] + 後續每行仍以 > 開頭
        // 更嚴格的匹配，確保不會跨越到下一個 admonition
        const reBQ = /^(?:^|\n)\s*>\s*\[\!\s*(Note|Tip|Important|Warning|Caution)\](?:[ \t]*\*{0,2}\s*([^\n*]+?)\s*\*{0,2})?\s*\r?\n((?:\s*>\s*(?!\[\!\s*(?:Note|Tip|Important|Warning|Caution)\])[^\n]*(?:\r?\n|$))*?)(?=\s*(?:\r?\n)*\s*(?:>?\s*\[\!\s*(?:Note|Tip|Important|Warning|Caution)\]|:::|$))/i;
        const mBQ = reBQ.exec(src);
        if (mBQ){
          const raw = mBQ[0];
          const cleaned = (mBQ[3]||'')
            .split(/\r?\n/)
            .map(l => l.replace(/^\s*>\s?/, ''))
            .join('\n');
          return { type:'admonition', raw, kind:mBQ[1].toLowerCase(), title:(mBQ[2]||'').trim(), text:cleaned.trim(), showLabel:true };
        }

        // B) 平鋪形式：[!Kind] [可選**標題**]（下一段為內容）
        const rePlain = /^(?:^|\n)\s*\[\!\s*(Note|Tip|Important|Warning|Caution)\](?:[ \t]*\*{0,2}\s*([^\n*]+?)\s*\*{0,2})?\s*\r?\n+((?:.*(?:\r?\n|$))*?)(?=(?:\r?\n{2,}|$))/i;
        const mPlain = rePlain.exec(src);
        if (mPlain){
          return { type:'admonition', raw:mPlain[0], kind:mPlain[1].toLowerCase(), title:(mPlain[2]||'').trim(), text:(mPlain[3]||'').trim(), showLabel:true };
        }

        // C) :::kind [可選同行標題] + 內容 + :::
        const re3 = /^(?:^|\n)\s*:::(\w+)(?:[ \t]+([^\n]+))?\s*\r?\n+((?:.*(?:\r?\n|$))*?):::\s*(?:\r?\n+|$)/;
        const m3 = re3.exec(src);
        if (m3){
          return { type:'admonition', raw:m3[0], kind:m3[1].toLowerCase(), title:(m3[2]||'').trim(), text:(m3[3]||'').trim(), showLabel:true };
        }
      },
      renderer(token){
        const inner = marked.parse(token.text);

        // 各種類型對應的 SVG
        const icons = {
          important: `<svg aria-hidden="true" height="16" width="16" viewBox="0 0 16 16" class="octicon octicon-report mr-2"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>`,
          note: `<svg aria-hidden="true" height="16" width="16" viewBox="0 0 16 16" class="octicon octicon-info mr-2"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>`,
          tip: `<svg aria-hidden="true" height="16" width="16" viewBox="0 0 16 16" class="octicon octicon-light-bulb mr-2"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>`
        };

        const icon = icons[token.kind] || "";
        const title = token.title ? `<span class="title">${icon}${token.title}</span>` : '';

        return `<div class="callout ${token.kind}">${title}${inner}</div>`;
      }
    };
    marked.use({ extensions:[admonitionExt] });

    const HACKMD_URL = 'https://hackmd.io/@INFAS/SylYomltgx/download';
    const CACHE_KEY  = 'md:recruit:v3';
    const CACHE_TTL  = 60 * 60 * 1000;

    const $root     = document.getElementById('md-root');
    const $toc      = document.getElementById('toc');
    const $fallback = document.getElementById('fallback');
    const $refresh  = document.getElementById('refresh');

    function buildTOC(container){
      // Only H2 per user's requirement
      const heads = container.querySelectorAll('h2');
      if(!heads.length){ $toc.innerHTML = '<span style="opacity:.7">（此頁暫無目錄）</span>'; return; }
      const ul = document.createElement('ul');
      heads.forEach(h=>{
        if(!h.id) h.id = slugify(h.textContent);
        const li = document.createElement('li');
        li.style.margin = '.3rem 0';
        const a = document.createElement('a');
        a.href = `#${h.id}`;
        a.textContent = h.textContent;
        li.appendChild(a);
        ul.appendChild(li);
      });
      $toc.replaceChildren(ul);
    }

    function postprocess(container){
      // external links
      container.querySelectorAll('a[href^="http"]').forEach(a=>{
        a.target = '_blank'; a.rel = 'noopener';
      });
      // task list
      container.querySelectorAll('li input[type="checkbox"]').forEach(cb=>{
        cb.disabled = true;
        cb.closest('li')?.classList.add('task-list-item');
      });
      
      // --- Handle callouts trapped in blockquotes ---
      container.querySelectorAll('blockquote').forEach(blockquote => {
        const callouts = blockquote.querySelectorAll('.callout');
        callouts.forEach(callout => {
          // Move each callout out of the blockquote and place it after the blockquote
          blockquote.parentNode.insertBefore(callout, blockquote.nextSibling);
          // Remove any indentation styles
          callout.style.marginLeft = '';
          callout.style.paddingLeft = '';
        });
        
        // If blockquote is now empty (or only contains whitespace), remove it
        if (!blockquote.textContent.trim() || blockquote.children.length === 0) {
          blockquote.remove();
        }
      });
      
      // --- Special handling for nested callouts ---
      container.querySelectorAll('.callout.note').forEach(noteCallout => {
        const nestedTips = noteCallout.querySelectorAll('.callout.tip');
        nestedTips.forEach(tipCallout => {
          noteCallout.parentNode.insertBefore(tipCallout, noteCallout.nextSibling);
          tipCallout.style.marginLeft = '';
          tipCallout.style.paddingLeft = '';
        });
      });
      
      // General nested callout flattening as backup
      let changed = true;
      let iterations = 0;
      while (changed && iterations < 10) {
        changed = false;
        iterations++;
        
        container.querySelectorAll('.callout .callout').forEach(nestedCallout => {
          const parentCallout = nestedCallout.closest('.callout');
          if (parentCallout && parentCallout !== nestedCallout) {
            parentCallout.parentNode.insertBefore(nestedCallout, parentCallout.nextSibling);
            nestedCallout.style.marginLeft = '';
            nestedCallout.style.paddingLeft = '';
            changed = true;
          }
        });
      }
      
      // Final cleanup: ensure all callouts at root level have proper styling
      container.querySelectorAll('.callout').forEach(callout => {
        if (!callout.closest('.callout .callout')) {
          callout.style.marginLeft = '';
          callout.style.paddingLeft = '';
        }
      });
    }

    function render(md){
      const raw = marked.parse(md);
      const clean = DOMPurify.sanitize(raw, { USE_PROFILES: { html: true, svg: true, svgFilters: true }});
      $root.innerHTML = clean;
      $root.setAttribute('aria-busy','false');
      buildTOC($root);
      postprocess($root);
    }

    function readCache(){
      try{
        const raw = localStorage.getItem(CACHE_KEY);
        if(!raw) return null;
        const { ts, md } = JSON.parse(raw);
        if(Date.now() - ts < CACHE_TTL) return md;
      }catch{}
      return null;
    }
    function writeCache(md){
      try{ localStorage.setItem(CACHE_KEY, JSON.stringify({ ts: Date.now(), md })); }catch{}
    }

    async function loadMarkdown({ refresh=false } = {}){
      $root.setAttribute('aria-busy','true');
      if(!refresh){
        const cached = readCache();
        if(cached){ render(cached); return; }
      }
      try{
        const res = await fetch(HACKMD_URL, { cache:'no-store' });
        if(!res.ok) throw new Error(`HTTP ${res.status}`);
        const md = await res.text();
        render(md);
        writeCache(md);
        $fallback.hidden = true;
      }catch(err){
        console.warn('HackMD 取用失敗：', err);
        $fallback.hidden = false;
        $root.setAttribute('aria-busy','false');
      }
    }

    $refresh.addEventListener('click', ()=>{
      try{ localStorage.removeItem(CACHE_KEY); }catch{}
      loadMarkdown({ refresh:true });
    });

    loadMarkdown();
  </script>
</body>
</html>